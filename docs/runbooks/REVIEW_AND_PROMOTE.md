# Review & Promotion Runbook

This runbook defines the **only approved process** for reviewing, approving, and promoting artifacts generated by the Long Horizon Agent into production execution.

No extractor or schedule may be promoted without completing this process.

---

## Purpose

The review and promotion process exists to:

- Prevent unsafe or incorrect automation
- Ensure extractors meet schema and reliability standards
- Make risks explicit before recurring execution
- Maintain auditability over time

This runbook is intentionally manual and explicit.

---

## Preconditions

Before review begins:

- A JobSpec has been approved
- Extractor artifacts exist in a `pending/` directory
- All required files are present

If any precondition is unmet, STOP.

---

## Required Review Artifacts

Each pending run MUST contain:

- `RUNBOOK.md`
- `RISKS.md`
- `TEST_REPORT.md`
- `sample_output.jsonl`
- `SCHEDULE.json`
- Extractor source code
- Tests

Missing artifacts are grounds for rejection.

---

## Step 1: Structural Review

Verify:

- Directory structure matches expectations
- No unexpected files are present
- No secrets or credentials are included
- No compiled binaries or vendor dumps exist

If violations are found, reject the run.

---

## Step 2: Code Review

Inspect the extractor code:

- Authentication logic is clear and minimal
- Network calls align with intended sources
- No dynamic dependency installs in prod paths
- No arbitrary shell execution
- No logging of sensitive data

If behavior is unclear or risky, reject or request revisions.

---

## Step 3: Validation Review

Check `TEST_REPORT.md`:

- All tests passed
- Schema validation succeeded
- Invariants were checked
- Failure-path behavior was exercised

If validation is incomplete, reject.

---

## Step 4: Data Sanity Check

Inspect `sample_output.jsonl`:

- Records validate against `tx_v1.schema.json`
- Amount signs are correct
- Dates make sense
- Currency codes are valid
- Duplicates are not present

If data quality is suspect, reject.

---

## Step 5: Risk Review

Read `RISKS.md` carefully:

- Authentication fragility is documented
- Rate limits are acknowledged
- Failure triggers are explicit
- Manual intervention requirements are clear

You must be comfortable owning these risks before promotion.

---

## Step 6: Schedule Review

Inspect `SCHEDULE.json`:

- Matches JobSpec cadence exactly
- Frequency is reasonable
- No hidden retries or loops exist

Schedules must never be modified during review without updating the JobSpec.

---

## Step 7: Promotion Decision

Choose one:

- **Approve**
  - Promote artifacts to `approved/`
  - Register schedule in production
- **Request Revisions**
  - Document required changes
  - Return to Extractor Builder
- **Reject**
  - Archive artifacts
  - Record rejection reason

All decisions must be recorded.

---

## Promotion Mechanics

Promotion consists of:

1. Copying artifacts from `pending/` to `approved/`
2. Recording:
   - approver
   - timestamp
   - JobSpec version
3. Enabling the production schedule

Promotion must be idempotent and reversible.

---

## Post-Promotion Verification

After first production run:

- Confirm execution succeeded
- Inspect output volume
- Verify transaction counts are reasonable
- Confirm no auth issues occurred

If issues arise, disable the schedule immediately.

---

## Emergency Stop

At any time, you may:

- Disable all schedules
- Revoke secrets
- Archive extractors

Safety always overrides continuity.

---

## Guiding Rule

> If you would not feel comfortable explaining this automation to your future self, do not promote it.
